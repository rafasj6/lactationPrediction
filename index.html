<html><head>
    <title>Lactation Prediction</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>

</head>

<p id = "p1"></p>

<script>
    const svgWidth = 600;
    const svgHeight = 500;
    const padding = 25;
    const width = svgWidth -(padding*2)
    const height = svgHeight -(padding*2)

    const fontSize =10;



    function createAxesAndGrids(xScale, yScale){
        let annotations = svg.append("g").attr("id","annotations");

        //Y axis (from class notes)
        let leftAxis = d3.axisLeft(yScale).tickSize(0);
        let leftGridlines = d3.axisLeft(yScale)
            .tickSize(-width)
            .tickFormat("")
        annotations.append("g")
            .attr("class", "y axis")
            .attr("transform","translate("+(padding)+","+0+")")
            .call(leftAxis)
        annotations.append("g")
            .attr("class", "y gridlines")
            .style("stroke", "lightgrey")
            .attr("transform","translate("+(padding)+","+0+")")
            .call(leftGridlines);

        // X axis (from class notes)
        let bottomAxis = d3.axisBottom(xScale).tickFormat(d3.timeFormat("%b '%y")); //help of https://bl.ocks.org/mbostock/5537697
        let bottomGridlines = d3.axisBottom(xScale)
                                .tickSize(-height)
                                .tickFormat("")
        annotations.append("g")
            .attr("class", "x axis")
            .attr("transform","translate("+0+","+(height+padding)+")")
            .call(bottomAxis);
        annotations.append("g")
            .attr("class", "x gridlines")
            .style("stroke", "lightgrey")

            .attr("transform","translate("+0+","+(height+padding)+")")
            .call(bottomGridlines);
    }


    svg = d3.select("#p1")
                .append("svg")
                .attr("width", svgWidth)
                .attr("height", svgHeight);

    d3.csv("lactation.csv").then( (data) => {



        const dateExtent = d3.extent(data, d => {return d3.timeParse("%m-%d-%YT%H:%M")(d['date'])});
        const dateScale = d3.scaleTime().domain(dateExtent).range([padding,svgWidth]);

        const yieldExtent = d3.extent(data, d => {return d['lactation_yield']});
        const yieldScale = d3.scaleLinear().domain(yieldExtent).range([svgHeight-padding, padding]);


        createAxesAndGrids(dateScale, yieldScale);

        console.log(dateScale)

        // Add the line
        svg.append("path")
            .datum(data)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-width", 1.5)
            .attr("d", d3.line()
                .x(function(d) { console.log(d);return dateScale(d.date) })
                .y(function(d) { return yieldScale(d.lactation_yield) })
                )
    })

   
   

                                        
</script>